---
sidebar: sidebar 
permalink: prev-ontap-restore-browse.html 
keywords: backing up, back up, backup, backup application data, Amazon Web services, AWS, NetApp Backup and Recovery, Oracle database, Microsoft SQL Server database, SAP HANA database 
summary: 使用NetApp Backup and Recovery and Recovery ，透過瀏覽和復原功能恢復ONTAP資料。 
---
= 使用“瀏覽和還原”功能還原ONTAP數據
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
使用NetApp Backup and Recovery and Recovery ，透過瀏覽和復原功能恢復ONTAP資料。在復原之前，請記下來源磁碟區名稱、來源系統和 SVM 以及備份檔案日期。您可以從快照、複製磁碟區或儲存在物件儲存中的備份還原ONTAP資料。

復原功能取決於您的ONTAP版本：

* *資料夾：* 使用ONTAP 9.13.0 或更高版本，您可以還原包含所有檔案和子資料夾的資料夾；使用早期版本，您只能還原資料夾中的檔案。
* *歸檔儲存：*從歸檔儲存復原（ ONTAP 9.10.1 或更高版本可用）速度較慢，並且可能會產生額外費用。
* *目標群集需求：*
+
** 磁碟區恢復： ONTAP 9.10.1 或更高版本
** 檔案復原： ONTAP 9.11.1 或更高版本
** Google Archive 和StorageGRID： ONTAP 9.12.1 或更高版本
** 資料夾恢復： ONTAP 9.13.1 或更高版本




link:prev-reference-aws-archive-storage-tiers.html["了解有關從 AWS 檔案儲存恢復的更多信息"]。link:prev-reference-azure-archive-storage-tiers.html["了解有關從 Azure 檔案儲存還原的詳細信息"]。link:prev-reference-gcp-archive-storage-tiers.html["詳細了解如何從 Google 存檔儲存中恢復"]。


NOTE: 將資料從 Azure 檔案儲存還原到StorageGRID系統時不支援高優先權。



== 瀏覽並恢復支援的系統和物件儲存提供者

您可以將ONTAP資料從位於二級系統（複製磁碟區）或物件儲存（備份檔案）中的備份檔案還原到下列系統。快照保存在來源系統上，並且只能還原到同一系統。

*注意：*您可以從任何類型的備份檔案還原卷，但目前只能從物件儲存中的備份檔案還原資料夾或單一檔案。

[cols="25,25,25,25"]
|===
| *來自物件儲存（備份）* | *來自主（快照）* | *來自輔助系統（複製）* | 至目的地系統 


| 亞馬遜 S3 | AWS 本機ONTAP系統中的Cloud Volumes ONTAP | AWS 本機ONTAP系統中的Cloud Volumes ONTAP | Azure Blob 


| Azure 本地端ONTAP系統中的Cloud Volumes ONTAP | Azure 本地端ONTAP系統中的Cloud Volumes ONTAP | Google 雲端儲存 | Google 本機ONTAP系統中的Cloud Volumes ONTAP 


| Google 本機ONTAP系統中的Cloud Volumes ONTAP | NetAppStorageGRID | 本地ONTAP系統 | 本機ONTAP系統Cloud Volumes ONTAP 


| 到本地ONTAP系統 | ONTAP S3 | 本地ONTAP系統 | 本機ONTAP系統Cloud Volumes ONTAP 
|===
對於瀏覽和恢復，控制台代理可以安裝在以下位置：

* 對於 Amazon S3，控制台代理可以部署在 AWS 或您的場所
* 對於 Azure Blob，控制台代理程式可以部署在 Azure 中或您的本機
* 對於 Google Cloud Storage，控制台代理程式必須部署在您的 Google Cloud Platform VPC 中
* 對於StorageGRID，控制台代理必須部署在您的場所；無論是否有網路存取
* 對於ONTAP S3，控制台代理可以部署在您的場所（有或沒有網路存取）或雲端供應商環境中


請注意，「本地ONTAP系統」包括FAS、 AFF和ONTAP Select系統。


NOTE: 如果您系統上的ONTAP版本低於 9.13.1，且備份檔案已配置 DataLock 和勒索軟體，則您無法還原資料夾或檔案。在這種情況下，您可以從備份檔案還原整個卷，然後存取所需的檔案。



== 使用「瀏覽和還原」還原卷

當您從備份檔案還原磁碟區時， NetApp Backup and Recovery會使用備份中的資料建立_新_磁碟區。使用物件儲存備份時，您可以將資料還原到原始系統中的磁碟區、與來源系統位於相同雲端帳戶的其他系統或本機ONTAP系統。

將雲端備份還原到使用ONTAP 9.13.0 或更高版本的Cloud Volumes ONTAP系統或執行ONTAP 9.14.1 的本機ONTAP系統時，您可以選擇執行_快速還原_操作。快速復原非常適合需要盡快提供對磁碟區的存取的災難復原情況。快速還原將備份檔案中的元資料還原到卷，而不是還原整個備份檔案。不建議對效能或延遲敏感的應用程式使用快速恢復，並且不支援歸檔儲存中的備份。


NOTE: 只有在建立雲端備份的來源系統執行ONTAP 9.12.1 或更高版本時， FlexGroup磁碟區才支援快速還原。並且僅當來源系統運行ONTAP 9.11.0 或更高版本時才支援SnapLock磁碟區。

從複製磁碟區還原時，您可以將磁碟區還原到原始系統或Cloud Volumes ONTAP或本機ONTAP系統。

image:diagram_browse_restore_volume.png["此圖顯示了使用瀏覽和還原執行磁碟區還原操作的流程。"]

若要還原卷，您需要來源系統名稱、儲存虛擬機器、磁碟區名稱和備份檔案日期。

.步驟
. 從控制台選單中，選擇*保護>備份和還原*。
. 選擇“*恢復*”選項卡，將顯示“恢復儀表板”。
. 從「瀏覽和復原」部分，選擇「恢復磁碟區」。
. 在「選擇來源」頁面中，導覽至要還原的磁碟區的備份檔案。選擇具有要還原的日期/時間戳記的*系統*、*磁碟區*和*備份*檔案。
+
「位置」欄位顯示備份檔案（快照）是「本機」（來源系統上的快照）、「輔助」（輔助ONTAP系統上的複製磁碟區）或「物件儲存」（物件儲存中的備份檔案）。選擇您想要恢復的檔案。

. 選擇“下一步”。
+
請注意，如果您選擇物件儲存中的備份文件，並且該備份的勒索軟體復原功能處於活動狀態（如果您在備份策略中啟用了 DataLock 和勒索軟體復原功能），則系統會提示您在復原資料之前對備份檔案執行額外的勒索軟體掃描。我們建議您掃描備份檔案以尋找勒索軟體。  （您將需要向雲端提供者支付額外的出口費用才能存取備份檔案的內容。）

. 在「選擇目標」頁面中，選擇要恢復磁碟區的*系統*。
. 從物件儲存還原備份檔案時，如果您選擇本機ONTAP系統且尚未配置與物件儲存的叢集連接，系統將提示您輸入其他資訊：
+
** 從 Amazon S3 還原時，選擇ONTAP叢集中目標磁碟區所在的 IP 空間，輸入您建立的使用者的存取金鑰和金鑰，以授予ONTAP叢集對 S3 儲存桶的存取權限，並可選擇選擇私有 VPC 端點以進行安全資料傳輸。
** 從 Azure Blob 還原時，選擇目標磁碟區所在的ONTAP叢集中的 IP 空間，選擇用於存取物件儲存的 Azure 訂閱，並透過選擇 VNet 和子網路來選擇用於安全資料傳輸的私人端點。
** 從 Google Cloud Storage 還原時，選擇 Google Cloud 專案以及存取金鑰和金鑰來存取物件儲存、儲存備份的區域以及目標磁碟區所在的ONTAP叢集中的 IP 空間。
** 從StorageGRID還原時，輸入StorageGRID伺服器的 FQDN 和ONTAP應用於與StorageGRID進行 HTTPS 通訊的端口，選擇存取物件儲存所需的存取金鑰和金鑰，以及目標磁碟區所在的ONTAP叢集中的 IP 空間。
** 從ONTAP S3 還原時，輸入ONTAP S3 伺服器的 FQDN 和ONTAP應用於與ONTAP S3 進行 HTTPS 通訊的端口，選擇存取物件儲存所需的存取金鑰和金鑰，以及目標磁碟區所在的ONTAP叢集中的 IP 空間。


. 輸入要用於復原的磁碟區的名稱，然後選擇磁碟區所在的儲存虛擬機器和聚合。還原FlexGroup磁碟區時，您需要選擇多個聚合。預設情況下，*<source_volume_name>_restore* 用作磁碟區名。
+
當將備份從物件儲存還原到使用ONTAP 9.13.0 或更高版本的Cloud Volumes ONTAP系統或執行ONTAP 9.14.1 的本機ONTAP系統時，您可以選擇執行_快速還原_操作。

+
如果您要從位於歸檔儲存層（從ONTAP 9.10.1 開始可用）中的備份檔案還原卷，則可以選擇還原優先權。

+
link:prev-reference-aws-archive-storage-tiers.html["了解有關從 AWS 檔案儲存恢復的更多信息"]。link:prev-reference-azure-archive-storage-tiers.html["了解有關從 Azure 檔案儲存還原的詳細信息"]。link:prev-reference-gcp-archive-storage-tiers.html["詳細了解如何從 Google 存檔儲存中恢復"]。Google Archive 儲存層中的備份檔案幾乎可以立即恢復，並且不需要恢復優先順序。

. 選擇「*下一步*」來選擇是否執行正常還原或快速還原程序：
+
** *正常還原*：在需要高效能的磁碟區上使用正常還原。還原過程完成之前，磁碟區將不可用。
** *快速恢復*：恢復的捲和資料將立即可用。請勿在需要高效能的磁碟區上使用此功能，因為在快速復原過程中，存取資料的速度可能會比平常慢。


. 選擇“*恢復*”，您將返回恢復儀表板，以便查看恢復操作的進度。


.結果
NetApp Backup and Recovery根據您選擇的備份建立一個新磁碟區。

請注意，從駐留在檔案儲存中的備份檔案還原磁碟區可能需要幾分鐘或幾小時，具體取決於檔案層和復原優先權。您可以選擇「作業監控」標籤來查看恢復進度。



== 使用“瀏覽和還原”還原資料夾和文件

如果您只需要從ONTAP磁碟區備份中還原幾個文件，則可以選擇還原資料夾或單一文件，而不是還原整個磁碟區。您可以將資料夾和檔案還原到原始系統中的現有捲，或還原到使用相同雲端帳戶的其他系統。您也可以將資料夾和檔案還原到本機ONTAP系統上的磁碟區。


NOTE: 目前，您只能從物件儲存中的備份檔案還原資料夾或單一檔案。目前不支援從本機快照或位於輔助系統（複製磁碟區）中的備份檔案還原檔案和資料夾。

如果選擇多個文件，它們將還原到同一目標磁碟區。若要將檔案還原到不同的捲，請多次執行該過程。

使用ONTAP 9.13.0 或更高版本時，您可以還原資料夾以及其中的所有檔案和子資料夾。使用 9.13.0 之前的ONTAP版本時，僅還原該資料夾中的檔案 - 不會還原子資料夾或子資料夾中的檔案。

[NOTE]
====
* 如果備份檔案已配置 DataLock 和勒索軟體保護，則僅當ONTAP版本為 9.13.1 或更高版本時才支援資料夾級還原。如果您使用的是早期版本的ONTAP，則可以從備份檔案還原整個卷，然後存取所需的資料夾和檔案。
* 如果備份檔案駐留在檔案儲存中，則僅當ONTAP版本為 9.13.1 或更高版本時才支援資料夾層級還原。如果您使用的是早期版本的ONTAP，則可以從尚未存檔的較新備份檔案中還原資料夾，也可以從已存檔的備份中還原整個磁碟區，然後存取所需的資料夾和檔案。
* 使用 ONTAP 9.15.1 ，您可以使用「瀏覽和復原」選項來還原 FlexGroup 資料夾。
+
您可以使用 https://community.netapp.com/t5/Tech-ONTAP-Blogs/BlueXP-Backup-and-Recovery-July-2024-Release/ba-p/453993#toc-hId-1830672444["NetApp Backup and Recovery2024 年 7 月版本博客"^]。



====


=== 還原資料夾和文件

請依照下列步驟將資料夾或檔案從ONTAP磁碟區備份還原到磁碟區。您應該知道要用於還原資料夾或檔案的磁碟區的名稱和備份檔案的日期。此功能使用即時瀏覽，以便您可以查看每個備份檔案中的目錄和檔案清單。

image:diagram_browse_restore_file.png["此圖顯示了使用瀏覽和復原執行檔復原操作的流程。"]

.開始之前
* ONTAP版本必須為 9.6 或更高版本才能執行_檔_復原操作。
* ONTAP版本必須為 9.11.1 或更高版本才能執行_資料夾_還原操作。如果資料位於檔案儲存中，或備份檔案使用 DataLock 和勒索軟體保護，則需要ONTAP版本 9.13.1。
* ONTAP版本必須為 9.15.1 p2 或更高版本才能使用瀏覽和還原選項還原FlexGroup目錄。


.步驟
. 從控制台選單中，選擇*保護>備份和還原*。
. 選擇“*恢復*”選項卡，將顯示“恢復儀表板”。
. 從「瀏覽和復原」部分，選擇「復原檔案或資料夾」。
. 在「選擇來源」頁面中，導覽至包含要還原的資料夾或檔案的磁碟區的備份檔案。選擇具有要從中復原檔案的日期/時間戳記的*系統*、*磁碟區*和*備份*。
. 選擇“*下一步*”，將顯示磁碟區備份中的資料夾和檔案清單。
+
如果您要從位於檔案儲存層的備份文件還原資料夾或文件，則可以選擇還原優先權。

+
link:prev-reference-aws-archive-storage-tiers.html["了解有關從 AWS 檔案儲存恢復的更多信息"]。link:prev-reference-azure-archive-storage-tiers.html["了解有關從 Azure 檔案儲存還原的詳細信息"]。link:prev-reference-gcp-archive-storage-tiers.html["詳細了解如何從 Google 存檔儲存中恢復"]。Google Archive 儲存層中的備份檔案幾乎可以立即恢復，並且不需要恢復優先順序。

+
如果備份檔案的勒索軟體復原功能處於活動狀態（如果您在備份策略中啟用了 DataLock 和勒索軟體復原功能），則會提示您在復原資料之前對備份檔案執行額外的勒索軟體掃描。我們建議您掃描備份檔案以尋找勒索軟體。  （您將需要向雲端提供者支付額外的出口費用才能存取備份檔案的內容。）

. 在「選擇項目」頁面中，選擇要復原的資料夾或文件，然後選擇「繼續」。為了幫助您找到該物品：
+
** 如果看到資料夾或檔案名，您可以選擇它。
** 您可以選擇搜尋圖示並輸入資料夾或檔案的名稱以直接導航到該項目。
** 您可以使用行尾的向下箭頭向下導航資料夾層級來尋找特定檔案。
+
當您選擇文件時，它們會被添加到頁面的左側，以便您可以看到已經選擇的文件。如果需要，您可以透過選擇檔案名稱旁邊的 *x* 從此清單中刪除檔案。



. 在「選擇目標」頁面中，選擇要還原項目的*系統*。
+
如果您選擇本地集群，並且尚未配置與物件儲存的集群連接，系統將提示您輸入其他資訊：

+
** 從 Amazon S3 還原時，輸入目標磁碟區所在的ONTAP叢集中的 IP 空間，以及存取物件儲存所需的 AWS 存取金鑰和金鑰。您也可以選擇專用連結配置來連接到叢集。
** 從 Azure Blob 還原時，輸入目標磁碟區所在的ONTAP叢集中的 IP 空間。您也可以為與叢集的連線選擇私有端點配置。
** 從 Google Cloud Storage 復原時，輸入目標磁碟區所在的ONTAP叢集中的 IP 空間，以及存取物件儲存所需的存取金鑰和金鑰。
** 從StorageGRID還原時，輸入StorageGRID伺服器的 FQDN 和ONTAP應用於與StorageGRID進行 HTTPS 通訊的端口，輸入存取物件儲存所需的存取金鑰和金鑰，以及目標磁碟區所在的ONTAP叢集中的 IP 空間。


. 然後選擇要還原資料夾或檔案的*磁碟區*和*資料夾*。
+
恢復資料夾和檔案時，您有幾個位置選項可供選擇。

+
** 當您選擇“選擇目標資料夾”時，如上所示：
+
*** 您可以選擇任意資料夾。
*** 您可以將滑鼠懸停在資料夾上，然後按一下行尾以深入查看子資料夾，然後選擇一個資料夾。


** 如果您選擇了與來源資料夾/檔案相同的目標系統和磁碟區，則可以選擇*維護來源資料夾路徑*將資料夾或檔案還原到來源結構中存在的相同資料夾。所有相同的資料夾和子資料夾必須已經存在；不會建立資料夾。將檔案還原到原始位置時，您可以選擇覆蓋來源檔案或建立新檔案。


. 選擇“恢復”返回恢復儀表板並查看恢復操作的進度。

