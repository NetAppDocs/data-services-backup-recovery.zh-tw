---
sidebar: sidebar 
permalink: br-use-vmware-restore-vmdks-from-backups.html 
keywords:  
summary: 您可以從傳統虛擬機器或 vVol 虛擬機器的主備份或輔助備份中還原現有的 VMDK 或已刪除或分離的 VMDK。 
---
= 從備份中還原特定虛擬磁碟
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
您可以從傳統虛擬機器的主備份或輔助備份中還原現有的虛擬磁碟 (VMDK)，或已刪除或已分離的虛擬磁碟。這樣，您就可以只恢復特定的虛擬機器資料或應用程序，而無需在僅影響特定資料的情況下恢復整個虛擬機器及其所有關聯的虛擬磁碟。虛擬磁碟復原後，會附加到其原始虛擬機，即可使用。

您可以將虛擬機器上的一個或多個虛擬機器磁碟 (VMDK) 還原到相同資料儲存或不同的資料儲存體。


TIP: 為了提高 NFS 環境中復原作業的效能，請啟用 VMware 應用程式 vStorage API for Array Integration (VAAI)。

.開始之前
* 必須存在備份。
* VM 不得處於傳輸狀態。
+
您要復原的虛擬機器不能處於 vMotion 或 Storage vMotion 狀態。



.關於此任務
* 如果 VMDK 被刪除或從 VM 中分離，則還原操作會將 VMDK 附加到 VM。
* 如果虛擬機器所在的FabricPool的儲存層不可用，則復原操作可能會失敗。
* 連接和恢復操作使用預設的 SCSi 控制器連接 VMDK。但是，當備份連接到具有 NVMe 磁碟的 VM 的 VMDK 時，連接和復原作業將使用 NVMe 控制器（如果可用）。


.步驟
. 從NetApp Backup and Recovery選單中，選擇 *復原*。
. 從名稱搜尋欄位右側的下拉清單中，選擇 *VMware*。
. 輸入要還原的資源的名稱，或篩選要還原的資源所在的 vCenter、資料中心或資料儲存。
+
將顯示符合您搜尋條件的虛擬機器清單。

. 在清單中找到要從中復原的虛擬機，然後選擇該虛擬機的選項選單按鈕。
. 在出現的選單中，選擇「恢復虛擬磁碟」。
+
顯示在該虛擬機器上建立的快照（還原點）清單。預設情況下，會顯示您在「時間範圍」下拉式選單中選擇的時間範圍內的最新快照。

+
對於每個快照，*位置*列中任何亮起的圖示都表示快照可用的儲存位置（主儲存、輔助儲存或物件儲存）。

. 啟用要還原的快照對應的單選按鈕。
. 選擇“下一步”。
+
顯示快照位置選項。

. 選擇快照的還原目標位置：
+
** *本地*：從本機位置還原快照。
** *輔助*：從遠端儲存位置還原快照。
** *物件儲存*：從物件儲存恢復快照。
+
如果選擇輔助存儲，請從下拉清單中選擇目標位置。



. 選擇“下一步”繼續。
. 選擇恢復目標位置和設定：


[discrete]
===== 目的地選擇

[role="tabbed-block"]
====
.恢復到原始位置
--
還原到原始位置時，您無法變更目標 vCenter、ESXi 主機、資料儲存或虛擬磁碟的名稱。原虛擬磁碟被覆蓋。

. 選擇「原始位置」窗格。
. 在「目標設定」部分，選取要還原的任何虛擬磁碟的核取方塊。
. 請從以下選項中選擇：
+
** *恢復前選項*部分：
+
*** *預設腳本*：啟用此選項可在復原作業開始前執行自訂腳本，以自動執行其他任務。請輸入要執行的腳本的完整路徑以及腳本接受的所有參數。


** *恢復後選項*部分：
+
*** *附註*：啟用此選項可在復原完成後執行自訂腳本，從而自動執行其他任務。請輸入要執行的腳本的完整路徑以及腳本接受的所有參數。




. 選擇*恢復*。


--
.恢復至備用位置
--
當恢復到備用位置時，您可以變更目標資料儲存。無論您選擇哪個資料存儲，恢復作業後虛擬磁碟都會附加到原始虛擬機器。

. 選擇「備用位置」窗格。
. 在「目標設定」部分，選取要還原的任何虛擬磁碟的核取方塊。
. 對於您選擇的任何虛擬磁碟：
+
.. 選擇「選擇資料儲存」可為虛擬磁碟選擇不同的資料儲存還原目標。
.. 選擇“選擇”以確認您的選擇並關閉選擇視窗。


. 請從以下選項中選擇：
+
** *恢復前選項*部分：
+
*** *預設腳本*：啟用此選項可在復原作業開始前執行自訂腳本，以自動執行其他任務。請輸入要執行的腳本的完整路徑以及腳本接受的所有參數。


** *恢復後選項*部分：
+
*** *附註*：啟用此選項可在復原完成後執行自訂腳本，從而自動執行其他任務。請輸入要執行的腳本的完整路徑以及腳本接受的所有參數。




. 選擇*恢復*。


--
====