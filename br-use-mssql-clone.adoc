---
sidebar: sidebar 
permalink: br-use-mssql-clone.html 
keywords: backing up, restoring, back up, backup, clone, restore, cloud volumes ontap, aws, azure, s3, blob, google cloud, storagegrid, back up volumes, cloud backup, restore volumes, cost, on-premises ontap, onprem, applications, virtual machines, backup and recovery 
summary: 複製 Microsoft SQL Server 應用程式資料以用於開發、測試或保護目的。 
---
= 使用NetApp Backup and RecoveryMicrosoft SQL Server 工作負載
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
使用NetApp Backup and Recovery將 Microsoft SQL Server 應用程式資料複製到 VM 以進行開發、測試或保護。從 SQL Server 工作負載的即時或現有快照建立複製。

從以下克隆類型中進行選擇：

* *即時快照和複製*：您可以從即時快照建立 Microsoft SQL Server 工作負載的克隆，即時快照是從備份建立的來源資料的時間點副本。克隆儲存在您的公有或私有雲帳戶的物件儲存中。如果資料遺失或損壞，您可以使用克隆來恢復您的工作負載。
* *從現有快照複製*：您可以從可用於工作負載的快照清單中選擇現有快照。如果您想從特定時間點建立克隆，此選項很有用。克隆到主存儲或輔助存儲。


您可以實現以下保護目標：

* 創建克隆
* 刷新克隆
* 分裂克隆
* 刪除克隆


*所需的NetApp Console角色* 儲存檢視器、備份和還原超級管理員或備份和還原備份管理員角色。 https://docs.netapp.com/us-en/console-setup-admin/reference-iam-predefined-roles.html["了解所有服務的NetApp Console存取角色"^] 。



== 創建克隆

您可以建立 Microsoft SQL Server 工作負載的複製。克隆是從備份建立的來源資料的副本。克隆儲存在您的公有或私有雲帳戶的物件儲存中。如果資料遺失或損壞，您可以使用克隆來恢復您的工作負載。

您可以從現有快照或即時快照建立複製。即時快照是根據備份建立的來源資料的時間點副本。如果資料遺失或損壞，您可以使用克隆來恢復您的工作負載。

.步驟
. 從NetApp Backup and Recovery選單中，選擇 *複製*。
. 選擇*建立新克隆*。
. 選擇克隆類型：
+
** *從現有快照克隆和刷新資料庫*：選擇快照並配置克隆選項。
** *即時快照和克隆*：立即對來源資料進行快照並從該快照建立克隆。如果您想要從來源工作負載中的最新資料建立克隆，此選項很有用。


. 完成*資料庫來源*部分：
+
** *單一克隆或批次克隆*：選擇建立單一克隆或多個克隆。如果您選擇*批次複製*，則可以使用已建立的保護群組一次建立多個克隆。如果您想為不同的工作負載建立多個克隆，此選項很有用。
** *來源資料庫主機、執行個體和名稱*：選擇複製的來源資料庫主機、執行個體和名稱。來源資料庫是將建立克隆的資料庫。


. 完成*資料庫目標*部分：
+
** *目標資料庫主機、執行個體和名稱*：選擇複製的目標資料庫主機、執行個體和名稱。目標資料庫是將建立克隆的位置。
+
或者，從目標名稱下拉清單中選擇 *Suffix*，並為克隆的資料庫名稱加上後綴。如果不加入後綴，克隆的資料庫名稱與來源資料庫名稱相同。

** *QoS（最大吞吐量）*：為複製選擇服務品質（QoS）最大吞吐量（MBps）。  QoS 定義了克隆的效能特徵，例如最大吞吐量和 IOPS。


. 完成*Mount*部分：
+
** *自動分配掛載點*：自動為物件儲存中的克隆分配掛載點。
** *定義掛載點路徑*：輸入複製的掛載點。掛載點是克隆將在物件儲存中掛載的位置。選擇磁碟機號，輸入資料檔路徑，輸入日誌檔案路徑。


. 選擇“下一步”。
. 選擇還原點：
+
** *現有快照*：從可用於工作負載的快照清單中選擇現有快照。如果您想從特定時間點建立克隆，此選項很有用。
** *即時快照和克隆*：從可用於工作負載的快照清單中選擇最新快照。如果您想要從來源工作負載中的最新資料建立克隆，此選項很有用。


. 如果您選擇建立*即時快照和複製*，請選擇複製儲存位置：
+
** *本機儲存*：選擇此選項可在ONTAP系統的本機儲存中建立複製。本機儲存是直接連接到ONTAP系統的儲存。
** *二級儲存*：選擇此選項可在ONTAP系統的二級儲存中建立克隆。輔助儲存是用於備份和還原工作負載的儲存。


. 選擇資料和日誌的目標位置。
. 選擇“下一步”。
. 完成*進階選項*部分。
. 如果您選擇*即時快照和克隆*，請完成以下選項：
+
** *克隆刷新計劃和到期時間*：如果您選擇*即時複製*，請輸入開始刷新克隆的日期。克隆計劃定義了何時建立克隆。
+
*** *如果計劃到期則刪除克隆*：如果您想在克隆到期日時刪除克隆。
*** *刷新克隆頻率*：選擇克隆的刷新頻率。您可以選擇每小時、每天、每週、每月或每季刷新克隆。如果您希望克隆與來源工作負載保持同步，則此選項很有用。


** *前言和後記*：可選地，添加在克隆創建之前和之後運行的腳本。這些腳本可以執行額外的任務，例如設定複製或發送通知。
** *通知*：可選地，指定電子郵件地址以接收有關複製建立狀態以及作業報告的通知。您也可以指定一個 webhook URL 來接收有關複製建立狀態的通知。您可以指定是否需要成功和失敗通知，或只需要其中一個。
** *標籤*：選擇標籤以協助您稍後搜尋資源組，然後選擇*應用程式*。例如，如果您將「HR」作為標籤新增至多個資源群組，則以後可以找到與「HR」標籤關聯的所有資源群組。


. 選擇“*創建*”。
. 當克隆創建完成後，您可以在*庫存*頁面中查看它。




== 刷新克隆

您可以刷新 Microsoft SQL Server 工作負載的克隆。刷新克隆會使用來源工作負載中的最新資料來更新克隆。如果您希望使克隆與來源工作負載保持同步，這將非常有用。

您可以選擇變更資料庫名稱、使用最新的即時快照或從現有生產快照刷新。

.步驟
. 從NetApp Backup and Recovery選單中，選擇 *複製*。
. 選擇要刷新的克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"]> *刷新克隆*。
. 完成“進階設定”部分：
+
** *復原範圍*：選擇是否要還原所有日誌備份或直到特定時間點的日誌備份。如果您想將克隆恢復到特定時間點，此選項很有用。
** *克隆刷新計劃和到期時間*：如果您選擇*即時複製*，請輸入開始刷新克隆的日期。克隆計劃定義了何時建立克隆。
+
*** *如果計劃到期則刪除克隆*：如果您想在克隆到期日時刪除克隆。
*** *刷新克隆頻率*：選擇克隆的刷新頻率。您可以選擇每小時、每天、每週、每月或每季刷新克隆。如果您希望克隆與來源工作負載保持同步，則此選項很有用。


** *iGroup 設定*：選擇克隆的 iGroup。iGroup 是用於存取複製的啟動器的邏輯分組。您可以選擇現有的 iGroup 或建立一個新的 iGroup。從主或輔助ONTAP儲存系統中選擇 iGroup。
** *前言和後記*：可選地，添加在克隆創建之前和之後運行的腳本。這些腳本可以執行額外的任務，例如設定複製或發送通知。
** *通知*：可選地，指定電子郵件地址以接收有關複製建立狀態以及作業報告的通知。您也可以指定一個 webhook URL 來接收有關複製建立狀態的通知。您可以指定是否需要成功和失敗通知，或只需要其中一個。
** *標籤*：輸入一個或多個標籤，以協助您稍後搜尋資源組。例如，如果您將「HR」作為標籤新增至多個資源群組，則以後可以找到與 HR 標籤關聯的所有資源群組。


. 在刷新確認對話方塊中，若要繼續，請選擇*刷新*。




== 跳過克隆刷新

跳過克隆刷新以保持克隆不變。

.步驟
. 從NetApp Backup and Recovery選單中，選擇 *複製*。
. 選擇您想要跳過刷新的克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"]> *跳過刷新*。
. 在「跳過刷新確認」對話方塊中，執行以下操作：
+
.. 若要僅跳過下一個刷新計劃，請選擇*僅跳過下一個刷新計劃*。
.. 若要繼續，請選擇*跳過*。






== 分裂克隆

您可以拆分 Microsoft SQL Server 工作負載的複製。拆分克隆將從克隆中建立一個新的備份。新的備份可用於恢復工作負載。

您可以選擇將克隆拆分為獨立克隆或長期克隆。精靈會顯示 SVM 的聚合清單、其大小以及複製磁碟區的位置。 NetApp Backup and Recovery也會指示是否有足夠的空間來分割克隆。克隆分裂後，克隆成為一個獨立的資料庫進行保護。

克隆作業不會被刪除，並且可以再次用於其他克隆。

.步驟
. 從NetApp Backup and Recovery選單中，選擇 *複製*。
. 選擇一個克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"]> *分裂克隆*。
. 查看拆分克隆詳細資訊並選擇*拆分*。
. 當分裂克隆創建完成後，您可以在*庫存*頁面中查看它。




== 刪除克隆

您可以刪除 Microsoft SQL Server 工作負載的複製。刪除克隆會從物件儲存中移除該複製並釋放儲存空間。

如果策略保護克隆，則克隆及其作業都會被刪除。

.步驟
. 從NetApp Backup and Recovery選單中，選擇 *複製*。
. 選擇一個克隆。
. 選擇“操作”圖標image:../media/icon-action.png["操作選項"]> *刪除克隆*。
. 在複製刪除確認對話方塊中，查看刪除詳細資訊。
+
.. 若要從SnapCenter中刪除克隆的資源，即使複製或其儲存不可訪問，也請選擇「強制刪除」。
.. 選擇*刪除*。


. 當克隆被刪除時，它將從*庫存*頁面中刪除。

